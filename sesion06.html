<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Módulo 6: Revocando Accesos y Auditando Privilegios</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .warm-gradient-3 {
            background: linear-gradient(90deg, #9a3412, #c2410c, #ea580c, #c2410c, #9a3412);
            background-size: 300% 300%;
            animation: gradient-animation 20s ease infinite;
        }
        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }
        /* Estilos para Acumulación de Privilegios */
        @keyframes collect-keys {
            0%, 20% { transform: translateX(0); }
            40%, 60% { transform: translateX(120px); } /* Ajustar según el ancho del contenedor */
            80%, 100% { transform: translateX(240px); }
        }
        .privilege-creep-user {
            animation: collect-keys 8s ease-in-out infinite;
        }
        .key-icon {
            opacity: 1;
            transition: opacity 0.5s;
        }
        /* Estilos para el simulador */
        .user-row.disabled {
            text-decoration: line-through;
            opacity: 0.6;
            background-color: #fee2e2; /* red-100 */
        }
    </style>
</head>
<body class="bg-amber-50 text-gray-900">

    <!-- ===== Header y Navegación ===== -->
    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-bold text-gray-800">
                <i class="fas fa-user-shield text-red-600"></i>
                Soporte de Auditoría TI
            </div>
            <div class="hidden md:flex space-x-6">
                <a href="#objetivos" class="text-gray-600 hover:text-red-600 transition duration-300">Objetivos</a>
                <a href="#conceptos" class="text-gray-600 hover:text-red-600 transition duration-300">Conceptos</a>
                <a href="#caso-practico" class="text-gray-600 hover:text-red-600 transition duration-300">Simulador</a>
            </div>
        </nav>
    </header>

    <!-- ===== Contenido Principal ===== -->
    <main>

        <!-- Sección Hero -->
        <section class="warm-gradient-3 text-white py-20 md:py-32">
            <div class="container mx-auto px-6 text-center reveal">
                <h1 class="text-4xl md:text-6xl font-extrabold mb-4" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.4);">Sesión 06: Revocando Accesos y Auditando Privilegios</h1>
                <p class="text-xl md:text-2xl max-w-3xl mx-auto" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.4);">Un acceso olvidado es una puerta abierta. Hoy aprenderás a cerrarlas y a verificar que solo los correctos tengan llave.</p>
            </div>
        </section>

        <div class="container mx-auto px-6 py-12">
            <!-- Sección de Objetivos -->
            <section id="objetivos" class="mb-20 p-8 bg-white rounded-xl shadow-lg reveal">
                <h2 class="text-3xl font-bold text-center text-gray-900 mb-8">Nuevas Responsabilidades del Guardián</h2>
                 <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="text-center p-6 bg-red-50 rounded-lg">
                        <i class="fas fa-user-slash text-4xl text-red-600 mb-4"></i>
                        <h3 class="text-xl font-semibold mb-2">Ejecutar Bajas</h3>
                        <p class="text-gray-600">Realizar el proceso correcto para deshabilitar cuentas de ex-empleados.</p>
                    </div>
                    <div class="text-center p-6 bg-red-50 rounded-lg">
                        <i class="fas fa-users text-4xl text-red-600 mb-4"></i>
                        <h3 class="text-xl font-semibold mb-2">Prevenir "Privilege Creep"</h3>
                        <p class="text-gray-600">Entender y visualizar el riesgo de la acumulación de privilegios.</p>
                    </div>
                    <div class="text-center p-6 bg-red-50 rounded-lg">
                        <i class="fas fa-tasks text-4xl text-red-600 mb-4"></i>
                        <h3 class="text-xl font-semibold mb-2">Realizar Revisiones</h3>
                        <p class="text-gray-600">Aprender el propósito y el proceso de la re-certificación periódica de accesos.</p>
                    </div>
                    <div class="text-center p-6 bg-red-50 rounded-lg">
                        <i class="fas fa-clipboard-check text-4xl text-red-600 mb-4"></i>
                        <h3 class="text-xl font-semibold mb-2">Generar Evidencia</h3>
                        <p class="text-gray-600">Documentar tanto las bajas como las revisiones de forma auditable.</p>
                    </div>
                </div>
            </section>

            <!-- Sección Conceptos -->
            <section id="conceptos" class="mb-20 reveal">
                 <h2 class="text-3xl font-bold text-center text-gray-900 mb-12">Conceptos Clave del Ciclo de Vida del Acceso</h2>
                 <div class="grid md:grid-cols-2 gap-12">
                     <!-- Bajas -->
                     <div class="bg-white p-8 rounded-xl shadow-lg">
                         <h3 class="text-2xl font-bold text-red-700 mb-4">El Proceso de Baja: Rápido y Preciso</h3>
                         <p class="text-gray-600 mb-4">Cuando un empleado se va, el tiempo es crítico. Un ex-empleado con acceso es un riesgo mayor. El objetivo es deshabilitar, no borrar.</p>
                         <ul class="space-y-3">
                             <li class="flex items-start"><i class="fas fa-check-circle text-green-500 mt-1 mr-3"></i><div><strong>Deshabilitar, no Borrar:</strong> Se deshabilita la cuenta para revocar el acceso instantáneamente, pero se preservan sus datos y auditoría. Borrarla podría causar pérdida de información.</div></li>
                             <li class="flex items-start"><i class="fas fa-check-circle text-green-500 mt-1 mr-3"></i><div><strong>Mover a OU Especial:</strong> La cuenta se mueve a una OU como "Usuarios Deshabilitados" para sacarla de las listas activas y aplicar políticas restrictivas.</div></li>
                         </ul>
                     </div>
                     <!-- Privilege Creep -->
                     <div class="bg-white p-8 rounded-xl shadow-lg">
                         <h3 class="text-2xl font-bold text-red-700 mb-4">El Peligro Silencioso: Acumulación de Privilegios</h3>
                         <p class="text-gray-600 mb-4">Ocurre cuando un empleado cambia de rol y se le dan nuevos permisos, pero nunca se le quitan los antiguos. Visualiza cómo un usuario acumula "llaves" innecesarias a lo largo del tiempo:</p>
                         <div class="bg-gray-100 p-4 rounded-lg relative h-24 overflow-hidden">
                             <div class="absolute top-10 left-4 privilege-creep-user">
                                 <i class="fas fa-user text-4xl text-blue-600"></i>
                                 <div id="user-keys" class="absolute -top-2 -right-6 flex"></div>
                             </div>
                             <div class="flex justify-around h-full items-center">
                                 <div class="text-center"><i class="fas fa-key text-2xl text-yellow-500 key-icon" data-role="Ventas"></i><p class="text-xs font-bold">Ventas</p></div>
                                 <div class="text-center"><i class="fas fa-key text-2xl text-yellow-500 key-icon" data-role="Marketing"></i><p class="text-xs font-bold">Marketing</p></div>
                                 <div class="text-center"><i class="fas fa-key text-2xl text-yellow-500 key-icon" data-role="Finanzas"></i><p class="text-xs font-bold">Finanzas</p></div>
                             </div>
                         </div>
                         <p id="creep-explanation" class="text-center font-semibold mt-2 text-gray-700">El usuario empieza en Ventas...</p>
                     </div>
                 </div>
            </section>

            <!-- Sección Caso Práctico -->
            <section id="caso-practico" class="reveal">
                <h2 class="text-3xl font-bold text-center text-gray-900 mb-2">Simulador: Consola de Auditoría de Accesos</h2>
                <p class="text-center text-gray-600 mb-12 max-w-3xl mx-auto">Te enfrentas a dos tareas críticas de un día normal: una solicitud de baja urgente y una revisión trimestral de accesos. Tu precisión es clave para mantener la seguridad.</p>

                <div class="bg-white rounded-xl shadow-2xl p-8">
                    <!-- Tarea 1: Baja de Usuario -->
                    <div class="mb-12">
                        <h3 class="text-xl font-bold mb-4">Tarea 1: Baja Urgente de Usuario</h3>
                        <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md mb-4" role="alert">
                            <p class="font-bold">Alerta de RRHH (Ticket: 812)</p>
                            <p>El contrato de la empleada "Ana Ventas" ha finalizado. Proceder con la deshabilitación inmediata de su cuenta.</p>
                        </div>
                        <div class="border rounded-lg p-4">
                            <h4 class="font-semibold mb-2">Lista de Usuarios Activos (OU: Ventas)</h4>
                            <div id="user-list-baja" class="space-y-2">
                                <div class="user-row flex justify-between items-center p-2 rounded"><span>Juan Pérez (jperez)</span><button class="invisible">Acción</button></div>
                                <div id="ana-ventas" class="user-row flex justify-between items-center p-2 rounded bg-yellow-100"><span>Ana Ventas (aventas)</span><button onclick="disableUser('ana-ventas')" class="bg-red-600 text-white font-semibold py-1 px-3 rounded hover:bg-red-700 text-sm">Deshabilitar</button></div>
                                <div class="user-row flex justify-between items-center p-2 rounded"><span>Luisa Rojas (lrojas)</span><button class="invisible">Acción</button></div>
                            </div>
                        </div>
                         <p id="baja-result" class="text-center font-semibold mt-4 text-green-700 opacity-0 transition-opacity">✅ Cuenta deshabilitada y movida a la OU "Usuarios Deshabilitados". Evidencia generada.</p>
                    </div>

                    <!-- Tarea 2: Revisión de Accesos -->
                    <div>
                        <h3 class="text-xl font-bold mb-4">Tarea 2: Re-certificación Trimestral de Permisos</h3>
                        <p class="mb-4">Como parte de la auditoría, debes revisar y certificar los accesos al **"Sistema de Reportes Financieros"**. El dueño del sistema es el Gerente de Finanzas. Revoca cualquier acceso que no corresponda.</p>
                        <div class="border rounded-lg overflow-hidden">
                            <table class="w-full text-left">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="p-3 font-semibold">Usuario</th>
                                        <th class="p-3 font-semibold">Departamento</th>
                                        <th class="p-3 font-semibold text-center">Acción</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-t">
                                        <td class="p-3">Carlos Finanzas (cfinanzas)</td>
                                        <td class="p-3">Finanzas</td>
                                        <td class="p-3 text-center"><button onclick="certifyAction(this, 'approve')" class="bg-gray-200 text-gray-700 font-semibold py-1 px-3 rounded-full hover:bg-green-200 text-sm w-24">Certificar</button></td>
                                    </tr>
                                    <tr class="border-t bg-yellow-100">
                                        <td class="p-3">David TI (dti)</td>
                                        <td class="p-3 font-bold text-red-600">TI</td>
                                        <td class="p-3 text-center"><button onclick="certifyAction(this, 'revoke')" class="bg-gray-200 text-gray-700 font-semibold py-1 px-3 rounded-full hover:bg-red-200 text-sm w-24">Certificar</button></td>
                                    </tr>
                                     <tr class="border-t">
                                        <td class="p-3">Sofia Contadora (scontadora)</td>
                                        <td class="p-3">Finanzas</td>
                                        <td class="p-3 text-center"><button onclick="certifyAction(this, 'approve')" class="bg-gray-200 text-gray-700 font-semibold py-1 px-3 rounded-full hover:bg-green-200 text-sm w-24">Certificar</button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <button id="finalize-review-btn" onclick="finalizeReview()" class="mt-6 w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition" disabled>Finalizar Revisión y Generar Evidencia</button>
                    </div>
                </div>
            </section>
            
            <!-- Sección de Cierre y Navegación -->
            <section class="text-center mt-20 reveal">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">Ciclo de Acceso Controlado</h2>
                <p class="text-lg text-gray-600 max-w-3xl mx-auto mb-8">Has dominado el ciclo de vida completo del acceso de un usuario. En la próxima sesión, nos adentraremos en la auditoría de la seguridad de las bases de datos.</p>
                 <div class="flex flex-col sm-flex-row justify-center items-center gap-4">
                    <a href="sesion5.html" class="w-full sm:w-auto inline-block border-2 border-red-600 text-red-600 font-bold py-3 px-8 rounded-lg shadow-md hover:bg-red-100 transition duration-300">
                        <i class="fas fa-arrow-left mr-2"></i> Regresar a la Sesión 5
                    </a>
                    <a href="sesion7.html" class="w-full sm:w-auto inline-block bg-red-600 text-white font-bold py-3 px-8 rounded-lg shadow-md hover:bg-red-700 transition duration-300">
                        Continuar a la Sesión 7 <i class="fas fa-arrow-right ml-2"></i>
                    </a>
                </div>
            </section>
        </div>
    </main>

    <!-- ===== Footer ===== -->
    <footer class="bg-gray-800 text-white mt-20">
        <div class="container mx-auto px-6 py-4 text-center">
            <p>&copy; 2025 - Unidad Didáctica: Soporte de Auditoría de TI. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>
        // --- General ---
        const revealElements = document.querySelectorAll('.reveal');
        const revealObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) entry.target.classList.add('visible');
            });
        }, { threshold: 0.1 });
        revealElements.forEach(el => revealObserver.observe(el));

        // --- Animación Privilege Creep ---
        const creepExplanation = document.getElementById('creep-explanation');
        const userKeysContainer = document.getElementById('user-keys');
        const roles = ['Ventas', 'Marketing', 'Finanzas'];
        let currentRoleIndex = 0;

        setInterval(() => {
            currentRoleIndex = (currentRoleIndex + 1) % roles.length;
            const currentRole = roles[currentRoleIndex];
            creepExplanation.textContent = `El usuario ahora está en ${currentRole}...`;
            
            const newKey = document.createElement('i');
            newKey.className = `fas fa-key text-lg text-yellow-500 ml-1`;
            userKeysContainer.appendChild(newKey);
            
            if (currentRoleIndex === 0) { // Reset
                 setTimeout(() => { userKeysContainer.innerHTML = ''; }, 1000);
            }
        }, 2666);


        // --- Simulador Baja ---
        function disableUser(userId) {
            const userRow = document.getElementById(userId);
            userRow.classList.add('disabled');
            userRow.querySelector('button').textContent = 'Deshabilitado';
            userRow.querySelector('button').disabled = true;
             userRow.querySelector('button').classList.replace('bg-red-600','bg-gray-400');
            document.getElementById('baja-result').classList.replace('opacity-0', 'opacity-100');
        }

        // --- Simulador Certificación ---
        let certifiedActions = 0;
        const totalActions = 3;
        const finalizeBtn = document.getElementById('finalize-review-btn');

        function certifyAction(button, action) {
            button.disabled = true;
            certifiedActions++;

            if (action === 'approve') {
                button.textContent = 'Certificado';
                button.classList.remove('bg-gray-200', 'hover:bg-green-200');
                button.classList.add('bg-green-500', 'text-white');
            } else { // revoke
                button.textContent = 'Revocado';
                 button.classList.remove('bg-gray-200', 'hover:bg-red-200');
                button.classList.add('bg-red-500', 'text-white');
            }
            
            if (certifiedActions === totalActions) {
                finalizeBtn.disabled = false;
            }
        }
        
        function finalizeReview(){
            alert("Revisión finalizada. Se ha generado el reporte de certificación de accesos (Evidencia: WP-ACC-REV-003) con la revocación del usuario 'dti'.");
            finalizeBtn.textContent = 'Evidencia Generada';
            finalizeBtn.classList.replace('bg-blue-600', 'bg-green-600');
            finalizeBtn.disabled = true;
        }

    </script>

</body>
</html>
